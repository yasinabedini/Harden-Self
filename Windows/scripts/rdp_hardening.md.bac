# ğŸ›¡ Windows Remote Desktop (RDP) Hardening â€” Unified Guide

**Scope:** Applies to Windows Serverâ€¯2016â€“2022 & Windowsâ€¯10/11 systems.  
**Goal:** Secure RDP sessions against credential theft, bruteâ€‘force, and lateral movement while enforcing encryption, authentication, and auditing.

---

## ğŸ”’ 1. Network Level Authentication (NLA)
Require credential validation before session creation.

**Registry**
```reg
[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp]
"UserAuthentication"=dword:00000001

Set-ItemProperty 'HKLM:\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp' -Name 'UserAuthentication' -Value 1


ğŸ” 2. Force High Encryption & TLSâ€¯1.2 / FIPSâ€‘Compliant Layer

[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp]
"MinEncryptionLevel"=dword:00000003
"SecurityLayer"=dword:00000002

TLS Enforcement

New-Item 'HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\TLS 1.0\Server' -Force |
Set-ItemProperty -Name 'Enabled' -Value 0
New-Item 'HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\TLS 1.2\Server' -Force |
Set-ItemProperty -Name 'Enabled' -Value 1


Security Goal: Ensures all RDP traffic uses secure TLS 1.2 or FIPS crypto.



ğŸ§± 3. Disable Redirections (Clipboard, Drives, COM, PnP)

[HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows NT\Terminal Services]
"fDisableClip"=1
"fDisableDrive"=1
"fDisableCcm"=1
"fDisableLPT"=1
"fDisablePNPRedir"=1

Security Goal: Stops data exfiltration via redirected local resources.


ğŸ•“ 4. Session Timeout & Autoâ€‘Disconnect

[HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows NT\Terminal Services]
"MaxIdleTime"=dword:000DBBA0       ; 900000â€¯ms (15â€¯min)
"MaxDisconnectionTime"=dword:000927C0 ; 10â€¯min

Security Goal: Kicks idle/disconnected sessions to limit hijacking risk.

ğŸš« 5. Restrict RDP Logon Rights

Path:

Computerâ€¯Configuration â†’ Windowsâ€¯Settings â†’ Securityâ€¯Settings â†’ Localâ€¯Policies â†’ Userâ€¯Rightsâ€¯Assignment â†’ Allowâ€¯logâ€¯onâ€¯throughâ€¯Remoteâ€¯Desktopâ€¯Services

Security Goal: Avoid nonâ€‘privileged users with remote access.

ğŸ§  6. Credentialâ€¯Guard & Virtualizationâ€‘Basedâ€¯Security

Enable isolation of credential secrets.

New-ItemProperty 'HKLM:\SYSTEM\CurrentControlSet\Control\DeviceGuard' -Name 'EnableVirtualizationBasedSecurity' -PropertyType DWord -Value 1
New-ItemProperty 'HKLM:\SYSTEM\CurrentControlSet\Control\Lsa' -Name 'LsaCfgFlags' -PropertyType DWord -Value 1
Security Goal: Protect LSASS credentials from theft through RDP memory exposure.


ğŸ” 7. Smartâ€¯Card or MFA for Logon

Require strong interactive logon.

[HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows NT\Terminal Services]
"fEnableSmartCard"=1


GPO path:

Administrativeâ€¯Templates â†’ Windowsâ€¯Components â†’ Remoteâ€¯Desktopâ€¯Services â†’ RDSHâ€¯â†’â€¯Security â†’ Require use of smart card for logonâ€¯=â€¯Enabled

Security Goal: Blocks passwordâ€‘based misuse in RDP sessions.


âš”ï¸ 8. Account Lockout & Antiâ€‘Bruteâ€‘Forrce

net accounts /lockoutthreshold:5 /lockoutduration:15 /lockoutwindow:15

Security Goal: Enforces lockout after repeated failed remote logon attempts.


ğŸ”¥ 9. Enable Firewall & RDP Port Obfuscation

Firewall
Set-NetFirewallProfile -Profile Domain,Private,Public -Enabled True
Enable-NetFirewallRule -Group "@FirewallAPI.dll,-28752"  # RDP Core group


Change RDP Port
Set-ItemProperty 'HKLM:\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp' -Name 'PortNumber' -Value 45289
New-NetFirewallRule -DisplayName "RDPâ€¯Secureâ€¯Portâ€¯45289" -Direction Inbound -Protocol TCP -LocalPort 45289 -Action Allow



ğŸ§¾ 10. Enable RDP Auditâ€¯&â€¯Logging

auditpol /set /subcategory:"Logon" /success:enable /failure:enable
auditpol /set /subcategory:"Network Connection" /success:enable /failure:enable

wevtutil sl "Microsoft-Windows-TerminalServices-LocalSessionManager/Operational" /e:true
wevtutil sl "Microsoft-Windows-TerminalServices-RemoteConnectionManager/Operational" /e:true

Security Goal: Capture session creation events (IDsâ€¯4624,â€¯4625,â€¯4778,â€¯4779).




ğŸ§© 11. Firewallâ€‘based Dynamic Bruteâ€‘Force Block (optional advanced)


Create rule triggered by failed logon count:

New-NetFirewallRule -DisplayName "TEMP_Block_RDP_BruteForce" -Direction Inbound -Protocol TCP -LocalPort 3389 -Action Block -RemoteAddress 0.0.0.0/0 -Profile Any

Automate removal afterâ€¯30â€¯mins viaâ€¯Taskâ€¯Scheduler or script.




